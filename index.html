<!DOCTYPE html>
<html lang="zh-Hant" id="main-html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        /* 簡潔實用的樣式 */
        body {
            background-color: #f8f9fa;
            font-family: 'Microsoft JhengHei', 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            padding: 1rem 0;
        }
        
        .navbar-brand {
            color: #2c3e50;
            font-weight: 600;
            font-size: 1.3rem;
        }
        
        /* 語言切換按鈕 */
        .lang-switcher {
            display: flex;
            gap: 0.5rem;
        }
        
        .lang-btn {
            background-color: #f8f9fa;
            border: 1px solid #ced4da;
            color: #495057;
            font-size: 0.85rem;
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .lang-btn:hover, .lang-btn.active {
            background-color: #007bff;
            border-color: #007bff;
            color: white;
        }
        
        /* 主要內容區域 */
        .container {
            max-width: 1200px;
            padding: 0 1rem;
        }
        
        /* 歡迎區域 */
        .welcome-section {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
        }
        
        .welcome-section h1 {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }
        
        .welcome-section p {
            color: #555;
            margin-bottom: 1rem;
        }
        
        /* 按鈕樣式 */
        .main-btn {
            background-color: #007bff;
            border: none;
            color: white;
            font-weight: 500;
            padding: 0.7rem 1.5rem;
            border-radius: 5px;
            transition: background-color 0.2s ease;
        }
        
        .main-btn:hover {
            background-color: #0056b3;
            color: white;
        }
        
        .secondary-btn {
            background-color: white;
            border: 1px solid #007bff;
            color: #007bff;
            font-weight: 500;
            padding: 0.7rem 1.5rem;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        
        .secondary-btn:hover {
            background-color: #f8f9fa;
            color: #0056b3;
        }
        
        /* 搜尋區域 */
        .search-section {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
        }
        
        .section-title {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }
        
        /* 表單元素 */
        .form-label {
            color: #495057;
            font-weight: 500;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .form-select {
            border: 1px solid #ced4da;
            border-radius: 5px;
            padding: 0.6rem;
            color: #495057;
            font-size: 0.95rem;
        }
        
        .form-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
            outline: none;
        }
        
        /* 步驟指示器 - 簡化版 */
        .steps-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }
        
        .step {
            text-align: center;
            position: relative;
            flex: 1;
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            background-color: #e9ecef;
            color: #6c757d;
            font-weight: 600;
            margin: 0 auto 0.5rem;
            border: 2px solid #dee2e6;
        }
        
        .step.active .step-number {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .step-label {
            color: #6c757d;
            font-size: 0.85rem;
        }
        
        .step.active .step-label {
            color: #2c3e50;
            font-weight: 500;
        }
        
        /* 結果區域 */
        .results-section {
            background-color: white;
            border-radius: 8px;
            margin-top: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
            overflow: hidden;
        }
        
        .results-header {
            background-color: #f8f9fa;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e9ecef;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .results-body {
            padding: 2rem;
            min-height: 200px;
        }
        
        .no-results {
            text-align: center;
            color: #6c757d;
            padding: 2rem 1rem;
        }
        
        /* 結果項目 */
        .result-item {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.2s ease;
        }
        
        .result-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        
        .result-title {
            color: #2c3e50;
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .result-meta {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .result-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            padding: 0.6rem 1.2rem;
            border-radius: 5px;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }
        
        .result-link:hover {
            background-color: #0056b3;
            color: white;
        }
        
        .result-link .bi {
            font-size: 1.2rem;
        }
        
        /* 上傳區域 */
        .upload-section {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            margin-top: 3rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
        }
        
        /* 隱私提示 */
        .privacy-tip {
            background-color: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 5px 5px 0;
        }
        
        .privacy-tip h5 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
        
        .privacy-tip p {
            color: #495057;
            margin-bottom: 0;
        }
        
        /* 功能特色 */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .feature-item {
            padding: 1.2rem;
            background-color: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        
        .feature-icon {
            color: #007bff;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }
        
        .feature-title {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }
        
        .feature-desc {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        /* 頁腳 */
        .footer {
            background-color: #f8f9fa;
            color: #6c757d;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 3rem;
            border-top: 1px solid #e9ecef;
            font-size: 0.9rem;
        }
        
        /* 響應式設計 */
        @media (max-width: 768px) {
            .container {
                padding: 0 0.75rem;
            }
            
            .welcome-section {
                padding: 1.5rem;
            }
            
            .welcome-section h1 {
                font-size: 1.5rem;
            }
            
            .search-section {
                padding: 1.2rem;
            }
            
            .steps-indicator {
                flex-direction: column;
                gap: 1.2rem;
            }
            
            .step {
                display: flex;
                align-items: center;
                gap: 1rem;
                text-align: left;
            }
            
            .step-number {
                margin: 0;
                flex-shrink: 0;
            }
            
            .upload-section {
                padding: 1.5rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .result-item {
                padding: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- 導航欄 -->
    <nav class="navbar">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center w-100">
                <a class="navbar-brand" href="#">
                </a>
                <div class="lang-switcher">
                    <button class="btn lang-btn active" onclick="changeLang('zh')" id="lang-btn-zh">繁體中文</button>
                    <button class="btn lang-btn" onclick="changeLang('en')" id="lang-btn-en">English</button>
                </div>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <!-- 歡迎區域 -->
        <div class="welcome-section">
            <h1 class="lang-text" data-en="Welcome to the Paper Repository System" data-zh="歡迎來到試卷題庫系統">
                歡迎來到試卷題庫系統
            </h1>
            <p class="lang-text" data-en="Find old examination papers from junior high to senior high: Chinese, English, Math, Physics, Chemistry, and Biology." data-zh="查找初中至高中的舊試卷：中文、英文、數學、物理、化學、生物。">
                查找初中至高中的舊試卷：中文、英文、數學、物理、化學、生物。
            </p>
            <p class="lang-text" data-en="Browse by grade, subject, term and year. Contribute by uploading your own papers (Google Form, admin-reviewed)." data-zh="可按年級、科目、學期及年份瀏覽，亦可透過 Google 表單上傳您的試卷（需經管理員審核後顯示）。">
                可按年級、科目、學期及年份瀏覽，亦可透過 Google 表單上傳您的試卷（需經管理員審核後顯示）。
            </p>
            <a href="#upload" class="btn secondary-btn mt-2 lang-text" data-en="Upload Your Paper" data-zh="上傳試卷">
                上傳試卷
            </a>
        </div>
        
        <!-- 步驟指示器 -->
        <div class="steps-indicator">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <div class="step-label lang-text" data-en="Grade" data-zh="年級">年級</div>
            </div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <div class="step-label lang-text" data-en="Subject" data-zh="科目">科目</div>
            </div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <div class="step-label lang-text" data-en="Term" data-zh="學期">學期</div>
            </div>
            <div class="step" id="step4">
                <div class="step-number">4</div>
                <div class="step-label lang-text" data-en="Year" data-zh="年份">年份</div>
            </div>
        </div>
        
        <!-- 搜尋區域 -->
        <div class="search-section">
            <h2 class="section-title lang-text" data-en="Browse Old Papers" data-zh="瀏覽舊試卷">瀏覽舊試卷</h2>
            
            <div class="row g-3">
                <!-- 年級選擇 -->
                <div class="col-lg-3 col-md-6">
                    <label class="form-label lang-text" data-en="Grade Level" data-zh="年級">年級</label>
                    <select class="form-select" id="gradeDropdown" onchange="handleGradeSelect(this.value)">
                        <option value="" selected class="lang-text" data-en="Select Grade" data-zh="選擇教育階段">選擇教育階段</option>
                        <option value="jh1" class="lang-text" data-en="Junior High 1" data-zh="初中一年級">初中一年級</option>
                        <option value="jh2" class="lang-text" data-en="Junior High 2" data-zh="初中二年級">初中二年級</option>
                        <option value="jh3" class="lang-text" data-en="Junior High 3" data-zh="初中三年級">初中三年級</option>
                        <option value="sh1" class="lang-text" data-en="Senior High 1" data-zh="高中一年級">高中一年級</option>
                        <option value="sh2" class="lang-text" data-en="Senior High 2" data-zh="高中二年級">高中二年級</option>
                        <option value="sh3" class="lang-text" data-en="Senior High 3" data-zh="高中三年級">高中三年級</option>
                        <option value="other" class="lang-text" data-en="Advanced Level" data-zh="進階學段">進階學段</option>
                    </select>
                </div>
                
                <!-- 科目選擇 -->
                <div class="col-lg-3 col-md-6">
                    <label class="form-label lang-text" data-en="Subject" data-zh="學科">學科</label>
                    <select class="form-select" id="subjectDropdown" onchange="handleSubjectSelect(this.value)">
                        <option value="" selected class="lang-text" data-en="Select Subject" data-zh="選擇學科">選擇學科</option>
                        <option value="chi" class="lang-text" data-en="Chinese Literature" data-zh="中文文學">中文文學</option>
                        <option value="eng" class="lang-text" data-en="English Language" data-zh="英語語言">英語語言</option>
                        <option value="math" class="lang-text" data-en="Mathematics" data-zh="數學">數學</option>
                        <option value="phy" class="lang-text" data-en="Physics" data-zh="物理">物理</option>
                        <option value="chem" class="lang-text" data-en="Chemistry" data-zh="化學">化學</option>
                        <option value="bio" class="lang-text" data-en="Biology" data-zh="生物">生物</option>
                    </select>
                </div>
                
                <!-- 學期選擇 -->
                <div class="col-lg-3 col-md-6">
                    <label class="form-label lang-text" data-en="Semester" data-zh="學期">學期</label>
                    <select class="form-select" id="termDropdown" onchange="handleTermSelect(this.value)">
                        <option value="" selected class="lang-text" data-en="Select Term" data-zh="選擇學期">選擇學期</option>
                        <option value="t1" class="lang-text" data-en="First Semester" data-zh="第一學期">第一學期</option>
                        <option value="t2" class="lang-text" data-en="Second Semester" data-zh="第二學期">第二學期</option>
                        <option value="t3" class="lang-text" data-en="Third Semester" data-zh="第三學期">第三學期</option>
                    </select>
                </div>
                
                <!-- 年份選擇 -->
                <div class="col-lg-3 col-md-6">
                    <label class="form-label lang-text" data-en="Academic Year" data-zh="學年">學年</label>
                    <select class="form-select" id="yearDropdown" onchange="handleYearSelect(this.value)">
                        <option value="" selected class="lang-text" data-en="Select Year" data-zh="選擇年份">選擇年份</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                    </select>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button class="btn main-btn" onclick="searchPapers()">
                    <i class="bi bi-search me-2"></i>
                    <span class="lang-text" data-en="Browse Old Papers" data-zh="瀏覽檔案">瀏覽檔案</span>
                </button>
            </div>
        </div>
        
        <!-- 結果區域 -->
        <div id="results-section" class="results-section" style="display: none;">
            <div class="results-header">
                <span id="results-title">搜尋結果</span>
            </div>
            <div class="results-body" id="results-body">
                <!-- 結果將動態顯示在這裡 -->
            </div>
            <div class="text-center p-3 border-top">
                <button class="btn secondary-btn" onclick="resetSearch()">
                    <i class="bi bi-arrow-left me-2"></i>
                    <span class="lang-text" data-en="New Search" data-zh="新搜尋">新搜尋</span>
                </button>
            </div>
        </div>
        
        <!-- 上傳區域 -->
        <div class="upload-section" id="upload">
            <h2 class="section-title lang-text" data-en="Upload Your Old Paper" data-zh="上傳您的舊試卷">上傳您的舊試卷</h2>
            
            <div class="privacy-tip">
                <h5 class="lang-text" data-en="Privacy Protection Guarantee" data-zh="隱私保護承諾">隱私保護承諾</h5>
                <p class="lang-text" data-en="All uploaded papers will be treated with strict confidentiality. We will redact personal information (names, student IDs, etc.) to protect uploaders' identities. All papers undergo administrator review before publication to ensure compliance with privacy policies." data-zh="所有上傳的試卷將嚴格保密處理。我們會對個人信息（姓名、學號等）進行打碼處理，以保護上傳者身份。所有試卷在發布前都會經過管理員審核，確保符合隱私政策。">
                    所有上傳的試卷將嚴格保密處理。我們會對個人信息（姓名、學號等）進行打碼處理，以保護上傳者身份。所有試卷在發布前都會經過管理員審核，確保符合隱私政策。
                </p>
            </div>
            
            <p class="lang-text" data-en="Anyone can upload their own old exam paper using Google Form. Uploaded content will be reviewed by the administrator before being added to the public system." data-zh="任何人都可以使用 Google 表單上傳自己的舊考卷。所有上傳內容由管理員審核後才會顯示在本系統。">
                任何人都可以使用 Google 表單上傳自己的舊考卷。所有上傳內容由管理員審核後才會顯示在本系統。
            </p>
            
            <div class="features-grid">
                <div class="feature-item">
                    <i class="bi bi-shield-check feature-icon"></i>
                    <div class="feature-title lang-text" data-en="Confidential Processing" data-zh="保密處理">保密處理</div>
                    <div class="feature-desc lang-text" data-en="All personal information will be redacted to protect your privacy." data-zh="所有個人信息將被遮蓋，保護您的隱私。">
                        所有個人信息將被遮蓋，保護您的隱私。
                    </div>
                </div>
                
                <div class="feature-item">
                    <i class="bi bi-eye-slash feature-icon"></i>
                    <div class="feature-title lang-text" data-en="Anonymous Upload" data-zh="匿名上傳">匿名上傳</div>
                    <div class="feature-desc lang-text" data-en="Uploader information is not displayed publicly. Only administrators can see uploader details." data-zh="上傳者信息不會公開顯示，僅管理員可見。">
                        上傳者信息不會公開顯示，僅管理員可見。
                    </div>
                </div>
                
                <div class="feature-item">
                    <i class="bi bi-clipboard-check feature-icon"></i>
                    <div class="feature-title lang-text" data-en="Administrator Review" data-zh="管理員審核">管理員審核</div>
                    <div class="feature-desc lang-text" data-en="All papers are reviewed to ensure quality and privacy compliance before publishing." data-zh="所有試卷都會經過審核，確保質量和隱私合規後才會發布。">
                        所有試卷都會經過審核，確保質量和隱私合規後才會發布。
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <a href="https://forms.gle/zDivK2A37ZDgNQDj8" target="_blank" rel="noopener noreferrer" class="btn main-btn">
                    <i class="bi bi-google me-2"></i>
                    <span class="lang-text" data-en="Upload via Google Form" data-zh="透過 Google 表單上傳">透過 Google 表單上傳</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- 頁腳 -->
    <div class="footer">
        <div class="container">
            <span class="lang-text" data-en="Paper Repository System" data-zh="試卷題庫系統">
                試卷題庫系統
            </span>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // 當前選擇狀態
        let currentGrade = null;
        let currentSubject = null;
        let currentTerm = null;
        let currentYear = null;
        let currentLang = 'zh'; // 預設為繁體中文
        
        // 試卷資料庫 (對應 Google Drive 連結) - 已修正：初中四年級改為高中一年級
        const paperDatabase = {
            // 初中一年級 (jh1) 數學試卷
            'jh1_math_t1_2024': {
                url: 'https://drive.google.com/drive/folders/119LgpjXMQwTa6NlacKMd8nNxXKQGNHiJ?usp=sharing',
                title_zh: '初中一年級數學第一學期 2024 年試卷',
                title_en: 'Junior High 1 Mathematics First Semester 2024 Papers'
            },
            'jh1_math_t2_2024': {
                url: 'https://drive.google.com/drive/folders/1eQDuvqVBzPZJzW3tF8iEMOLDEwNNebE_?usp=sharing',
                title_zh: '初中一年級數學第二學期 2024 年試卷',
                title_en: 'Junior High 1 Mathematics Second Semester 2024 Papers'
            },
            'jh1_math_t3_2024': {
                url: 'https://drive.google.com/drive/folders/1X-I3xVTGpEMA6iMND7OnXEfm2yeYlzP2?usp=sharing',
                title_zh: '初中一年級數學第三學期 2024 年試卷',
                title_en: 'Junior High 1 Mathematics Third Semester 2024 Papers'
            },
            
            // 初中二年級 (jh2) 數學試卷
            'jh2_math_t1_2024': {
                url: 'https://drive.google.com/drive/folders/1O_tUo65LEPQ_rIPZC4MPw-0vjUM_l_Xa?usp=sharing',
                title_zh: '初中二年級數學第一學期 2024 年試卷',
                title_en: 'Junior High 2 Mathematics First Semester 2024 Papers'
            },
            'jh2_math_t2_2024': {
                url: 'https://drive.google.com/drive/folders/1rt961rIXMdb6AxiEqsJ4RLWeZ7bPNBha?usp=sharing',
                title_zh: '初中二年級數學第二學期 2024 年試卷',
                title_en: 'Junior High 2 Mathematics Second Semester 2024 Papers'
            },
            'jh2_math_t3_2024': {
                url: 'https://drive.google.com/drive/folders/1j2rMv-wBEvKSGxt7huuFOow6sERq-sJk?usp=sharing',
                title_zh: '初中二年級數學第三學期 2024 年試卷',
                title_en: 'Junior High 2 Mathematics Third Semester 2024 Papers'
            },
            
            // 初中三年級 (jh3) 數學試卷
            'jh3_math_t1_2024': {
                url: 'https://drive.google.com/drive/folders/1utr4P0eRwPpCxm-NEbFnVhh7XxCXBU3Q?usp=sharing',
                title_zh: '初中三年級數學第一學期 2024 年試卷',
                title_en: 'Junior High 3 Mathematics First Semester 2024 Papers'
            },
            'jh3_math_t2_2024': {
                url: 'https://drive.google.com/drive/folders/1qEPzSCWV2Vq4iRwvWAFGpBTBt_pt_FS3?usp=sharing',
                title_zh: '初中三年級數學第二學期 2024 年試卷',
                title_en: 'Junior High 3 Mathematics Second Semester 2024 Papers'
            },
            'jh3_math_t3_2024': {
                url: 'https://drive.google.com/drive/folders/1I7FG1XL05WUXzaTZWtG-IUHuAk46Zk3d?usp=sharing',
                title_zh: '初中三年級數學第三學期 2024 年試卷',
                title_en: 'Junior High 3 Mathematics Third Semester 2024 Papers'
            },
            
            // 高中一年級 (sh1) 數學試卷 - 原初中四年級改為高中一年級
            'sh1_math_t1_2024': {
                url: 'https://drive.google.com/drive/folders/1afHqd0lR_rAPP97cba9RzHYceAgHTMWD?usp=sharing',
                title_zh: '高中一年級數學第一學期 2024 年試卷',
                title_en: 'Senior High 1 Mathematics First Semester 2024 Papers'
            },
            'sh1_math_t2_2024': {
                url: 'https://drive.google.com/drive/folders/1AhVY9_-nKXjhVwj23c03gl3QjaPsute8?usp=sharing',
                title_zh: '高中一年級數學第二學期 2024 年試卷',
                title_en: 'Senior High 1 Mathematics Second Semester 2024 Papers'
            },
            'sh1_math_t3_2024': {
                url: 'https://drive.google.com/drive/folders/1I7FG1XL05WUXzaTZWtG-IUHuAk46Zk3d?usp=sharing',
                title_zh: '高中一年級數學第三學期 2024 年試卷',
                title_en: 'Senior High 1 Mathematics Third Semester 2024 Papers'
            },
            
            // 其他科目範例資料
            'jh1_chi_t1_2024': {
                url: 'https://drive.google.com/drive/folders/sample_chi_folder?usp=sharing',
                title_zh: '初中一年級中文第一學期 2024 年試卷',
                title_en: 'Junior High 1 Chinese First Semester 2024 Papers'
            },
            'jh1_eng_t1_2024': {
                url: 'https://drive.google.com/drive/folders/sample_eng_folder?usp=sharing',
                title_zh: '初中一年級英文第一學期 2024 年試卷',
                title_en: 'Junior High 1 English First Semester 2024 Papers'
            },
            'sh1_chi_t1_2024': {
                url: 'https://drive.google.com/drive/folders/sample_sh1_chi_folder?usp=sharing',
                title_zh: '高中一年級中文第一學期 2024 年試卷',
                title_en: 'Senior High 1 Chinese First Semester 2024 Papers'
            }
        };
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化語言為繁體中文
            changeLang('zh');
            
            // 啟用所有下拉選單
            document.getElementById('subjectDropdown').disabled = false;
            document.getElementById('termDropdown').disabled = false;
            document.getElementById('yearDropdown').disabled = false;
            
            updateSteps();
        });
        
        // 處理年級選擇
        function handleGradeSelect(value) {
            currentGrade = value;
            updateSteps();
        }
        
        // 處理科目選擇
        function handleSubjectSelect(value) {
            currentSubject = value;
            updateSteps();
        }
        
        // 處理學期選擇
        function handleTermSelect(value) {
            currentTerm = value;
            updateSteps();
        }
        
        // 處理年份選擇
        function handleYearSelect(value) {
            currentYear = value;
            updateSteps();
        }
        
        // 更新步驟指示器
        function updateSteps() {
            // 重置所有步驟
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            
            // 激活相應步驟
            if (currentGrade) {
                document.getElementById('step1').classList.add('active');
            }
            if (currentSubject) {
                document.getElementById('step2').classList.add('active');
            }
            if (currentTerm) {
                document.getElementById('step3').classList.add('active');
            }
            if (currentYear) {
                document.getElementById('step4').classList.add('active');
            }
        }
        
        // 搜尋試卷
        function searchPapers() {
            // 檢查是否所有欄位都已填寫
            if (!currentGrade || !currentSubject || !currentTerm || !currentYear) {
                const alertMsg = currentLang === 'zh' ? 
                    '請填寫所有搜尋條件！' : 
                    'Please fill in all search criteria!';
                alert(alertMsg);
                return;
            }
            
            // 顯示結果區域
            showResults();
        }
        
        // 顯示結果
        function showResults() {
            // 更新結果標題
            updateResultsTitle();
            
            // 加載結果
            loadResults();
            
            // 顯示結果區域
            document.getElementById('results-section').style.display = 'block';
            
            // 滾動到結果區域
            document.getElementById('results-section').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // 更新結果標題
        function updateResultsTitle() {
            const gradeNames = {
                jh1: { en: "Junior High 1", zh: "初中一年級" },
                jh2: { en: "Junior High 2", zh: "初中二年級" },
                jh3: { en: "Junior High 3", zh: "初中三年級" },
                sh1: { en: "Senior High 1", zh: "高中一年級" },
                sh2: { en: "Senior High 2", zh: "高中二年級" },
                sh3: { en: "Senior High 3", zh: "高中三年級" },
                other: { en: "Advanced Level", zh: "進階學段" }
            };
            
            const subjectNames = {
                chi: { en: "Chinese Literature", zh: "中文文學" },
                eng: { en: "English Language", zh: "英語語言" },
                math: { en: "Mathematics", zh: "數學" },
                phy: { en: "Physics", zh: "物理" },
                chem: { en: "Chemistry", zh: "化學" },
                bio: { en: "Biology", zh: "生物" }
            };
            
            const termNames = {
                t1: { en: "First Semester", zh: "第一學期" },
                t2: { en: "Second Semester", zh: "第二學期" },
                t3: { en: "Third Semester", zh: "第三學期" }
            };
            
            const gradeText = gradeNames[currentGrade] ? gradeNames[currentGrade][currentLang] : currentGrade;
            const subjectText = subjectNames[currentSubject] ? subjectNames[currentSubject][currentLang] : currentSubject;
            const termText = termNames[currentTerm] ? termNames[currentTerm][currentLang] : currentTerm;
            
            const title = currentLang === 'zh' ? 
                `搜尋結果：${gradeText} / ${subjectText} / ${termText} / ${currentYear}` :
                `Search Results: ${gradeText} / ${subjectText} / ${termText} / ${currentYear}`;
            
            document.getElementById('results-title').textContent = title;
        }
        
        // 加載結果
        function loadResults() {
            const resultsBody = document.getElementById('results-body');
            
            // 清空現有內容
            resultsBody.innerHTML = '';
            
            // 創建資料庫索引鍵
            const dbKey = `${currentGrade}_${currentSubject}_${currentTerm}_${currentYear}`;
            
            // 檢查資料庫中是否有對應的資料
            if (paperDatabase[dbKey]) {
                // 有資料，顯示結果
                displayPaperResult(paperDatabase[dbKey]);
            } else {
                // 無資料，顯示提示訊息
                displayNoResults(dbKey);
            }
        }
        
        // 顯示試卷結果
        function displayPaperResult(paperData) {
            const resultsBody = document.getElementById('results-body');
            
            // 創建結果項目容器
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';
            
            // 創建標題
            const titleDiv = document.createElement('div');
            titleDiv.className = 'result-title';
            titleDiv.textContent = currentLang === 'zh' ? 
                paperData.title_zh : paperData.title_en;
            
            // 創建元數據
            const metaDiv = document.createElement('div');
            metaDiv.className = 'result-meta';
            const metaText = currentLang === 'zh' ? 
                '已找到對應的試卷檔案，點擊下方連結查看：' : 
                'Matching paper found. Click the link below to view:';
            metaDiv.textContent = metaText;
            
            // 創建連結
            const linkDiv = document.createElement('div');
            const linkElement = document.createElement('a');
            linkElement.href = paperData.url;
            linkElement.target = '_blank';
            linkElement.rel = 'noopener noreferrer';
            linkElement.className = 'result-link';
            
            // 創建連結圖標
            const linkIcon = document.createElement('i');
            linkIcon.className = 'bi bi-google-drive';
            
            // 創建連結文字
            const linkText = document.createElement('span');
            linkText.textContent = currentLang === 'zh' ? 
                '前往 Google Drive 查看試卷' : 
                'View Papers on Google Drive';
            
            // 組合連結
            linkElement.appendChild(linkIcon);
            linkElement.appendChild(linkText);
            linkDiv.appendChild(linkElement);
            
            // 組合所有元素
            resultItem.appendChild(titleDiv);
            resultItem.appendChild(metaDiv);
            resultItem.appendChild(linkDiv);
            
            // 添加到結果區域
            resultsBody.appendChild(resultItem);
        }
        
        // 顯示無結果訊息
        function displayNoResults(dbKey) {
            const resultsBody = document.getElementById('results-body');
            
            // 創建無結果訊息
            const noResultsDiv = document.createElement('div');
            noResultsDiv.className = 'no-results';
            
            // 圖標
            const icon = document.createElement('i');
            icon.className = 'bi bi-file-earmark-text';
            icon.style.fontSize = '3rem';
            icon.style.color = '#dee2e6';
            icon.style.marginBottom = '1rem';
            
            // 主訊息
            const message = document.createElement('p');
            const messageText = currentLang === 'zh' ? 
                '暫無符合條件的試卷檔案。成為首個貢獻者！' : 
                'No matching archival documents found. Be the inaugural contributor!';
            message.textContent = messageText;
            message.style.marginBottom = '1rem';
            
            // 提示訊息
            const hintMessage = document.createElement('p');
            hintMessage.style.fontSize = '0.9rem';
            hintMessage.style.color = '#6c757d';
            const hintText = currentLang === 'zh' ? 
                '如果您有此試卷，歡迎透過下方上傳功能分享給大家！' : 
                'If you have this paper, please share it through the upload section below!';
            hintMessage.textContent = hintText;
            
            noResultsDiv.appendChild(icon);
            noResultsDiv.appendChild(message);
            noResultsDiv.appendChild(hintMessage);
            resultsBody.appendChild(noResultsDiv);
        }
        
        // 重置搜尋
        function resetSearch() {
            // 重置選擇
            currentGrade = null;
            currentSubject = null;
            currentTerm = null;
            currentYear = null;
            
            // 重置下拉選單
            document.getElementById('gradeDropdown').selectedIndex = 0;
            document.getElementById('subjectDropdown').selectedIndex = 0;
            document.getElementById('termDropdown').selectedIndex = 0;
            document.getElementById('yearDropdown').selectedIndex = 0;
            
            // 隱藏結果區域
            document.getElementById('results-section').style.display = 'none';
            
            // 重置步驟
            updateSteps();
            
            // 滾動回頂部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // 語言切換
        function changeLang(lang) {
            currentLang = lang;
            
            // 更新html lang屬性
            document.getElementById('main-html').setAttribute('lang', lang === 'zh' ? 'zh-Hant' : 'en');
            
            // 更新所有語言文字
            document.querySelectorAll('.lang-text').forEach(element => {
                const text = element.getAttribute(`data-${lang}`);
                if (text) {
                    element.textContent = text;
                }
            });
            
            // 更新語言按鈕狀態
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll(`#lang-btn-${lang}`).forEach(btn => {
                btn.classList.add('active');
            });
            
            // 如果有顯示結果，重新載入結果
            if (currentGrade && currentSubject && currentTerm && currentYear) {
                updateResultsTitle();
                loadResults();
            }
        }
        
        // 滾動平滑處理
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>